---
title: "Subsample"
date: "2021-09-29"
output: html_fragment
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

### Purpose

Subsample your abundance data to a fixed count per sample. For example, if 
300-organisms is your target, and any of your samples have more than 300 
organisms, you can use this function to randomly subsample your data so that the
total number of individuals is 300. This is done to make richness metrics 
comparable (since higher numbers of taxa generally occur in samples in which 
more individuals are counted). The function is based on code from USEPA 
Corvallis John Van Sickle’s R code for RIVPACS (v1.0, 2005-06-10).

### Instructions

* Upload a file under "Load Data".  The status bar will tell you when the upload
is complete.  Then return to this screen.

    +	Required fields: Sample ID, Taxa ID, Count

*	Enter the desired subsample size (e.g., 300 organisms)

* If desire results to be repeatable enter a 'seed' value.  Preferably 8 digits 
or more (e.g., the numbers from a date in the format of yyyymmdd).

*	Click the ‘Run Function’ button; a status bar will appear in the lower right 
corner.

*	After the function is done running, the ‘Download Results’ button will be 
active. Click this button to retrieve your results.

*	Save the file in the desired folder. There will be two output files (in 
comma-delimited format):

    +	A file with subsample results only (three columns: Sample ID and updated 
    TaxaID and Count fields, subsampled to the desired number of organisms)

    +	A file showing original vs. subsampled results (four columns: SampleID, 
    TaxaID, original counts, subsampled counts) – see example below.

![Example Subsample](Shiny_Subsample.png)

### Additional Notes

Right now the function is set up to provide random but repeatable results 
(meaning if you run the same input file through more than once, you will get the
same result each time). If you are skilled with R, you could download the R 
package from GitHub (https://github.com/leppott/BioMonTools) and customize the 
code. You could also adjust the upper limit on the number of organisms that
trigger subsampling (for example, set it up so that the R code only subsamples 
when samples have over 20% of the target number of total individuals).

*Last updated 2022-01-12*
